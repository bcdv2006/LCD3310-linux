/***************************************************************/
/***********   THU VIEN LCD 3310/5110 CHO 8051  ****************/
/***********    VIET BOI LEDACDAM .02/01/2016   ****************/
/***********             0968029569             ****************/
/***************************************************************/




/********************** DINH NGHIA CAC CHAN LCD ******************/
sbit  RST = P2^0; 
sbit  CE  = P2^1; 
sbit  DC  = P2^2; 
sbit  DIN = P2^3; 
sbit  CLK = P2^4;
/********************** FONT CHU *********************************/
unsigned char code font5[][5] = 
{ 
    { 0x00, 0x00, 0x00, 0x00, 0x00 },  // sp 
    { 0x00, 0x00, 0x2f, 0x00, 0x00 },   // ! 
    { 0x00, 0x07, 0x00, 0x07, 0x00 },   // " 
    { 0x14, 0x7f, 0x14, 0x7f, 0x14 },   // # 
    { 0x24, 0x2a, 0x7f, 0x2a, 0x12 },   // $ 
    { 0xc4, 0xc8, 0x10, 0x26, 0x46 },   // % 
    { 0x36, 0x49, 0x55, 0x22, 0x50 },   // & 
    { 0x00, 0x05, 0x03, 0x00, 0x00 },   // ' 
    { 0x00, 0x1c, 0x22, 0x41, 0x00 },   // ( 
    { 0x00, 0x41, 0x22, 0x1c, 0x00 },   // ) 
    { 0x14, 0x08, 0x3E, 0x08, 0x14 },   // * 
    { 0x08, 0x08, 0x3E, 0x08, 0x08 },   // + 
    { 0x00, 0x00, 0x50, 0x30, 0x00 },   // , 
    { 0x10, 0x10, 0x10, 0x10, 0x10 },   // - 
    { 0x00, 0x60, 0x60, 0x00, 0x00 },   // . 
    { 0x20, 0x10, 0x08, 0x04, 0x02 },   // / 
    { 0x3E, 0x51, 0x49, 0x45, 0x3E },   // 0 
    { 0x00, 0x42, 0x7F, 0x40, 0x00 },   // 1 
    { 0x42, 0x61, 0x51, 0x49, 0x46 },   // 2 
    { 0x21, 0x41, 0x45, 0x4B, 0x31 },   // 3 
    { 0x18, 0x14, 0x12, 0x7F, 0x10 },   // 4 
    { 0x27, 0x45, 0x45, 0x45, 0x39 },   // 5 
    { 0x3C, 0x4A, 0x49, 0x49, 0x30 },   // 6 
    { 0x01, 0x71, 0x09, 0x05, 0x03 },   // 7 
    { 0x36, 0x49, 0x49, 0x49, 0x36 },   // 8 
    { 0x06, 0x49, 0x49, 0x29, 0x1E },   // 9 
    { 0x00, 0x36, 0x36, 0x00, 0x00 },   // : 
    { 0x00, 0x56, 0x36, 0x00, 0x00 },   // ; 
    { 0x08, 0x14, 0x22, 0x41, 0x00 },   // < 
    { 0x14, 0x14, 0x14, 0x14, 0x14 },   // = 
    { 0x00, 0x41, 0x22, 0x14, 0x08 },   // > 
    { 0x02, 0x01, 0x51, 0x09, 0x06 },   // ? 
    { 0x32, 0x49, 0x59, 0x51, 0x3E },   // @ 
    { 0x7E, 0x11, 0x11, 0x11, 0x7E },   // A 
    { 0x7F, 0x49, 0x49, 0x49, 0x36 },   // B 
    { 0x3E, 0x41, 0x41, 0x41, 0x22 },   // C 
    { 0x7F, 0x41, 0x41, 0x22, 0x1C },   // D 
    { 0x7F, 0x49, 0x49, 0x49, 0x41 },   // E 
    { 0x7F, 0x09, 0x09, 0x09, 0x01 },   // F 
    { 0x3E, 0x41, 0x49, 0x49, 0x7A },   // G 
    { 0x7F, 0x08, 0x08, 0x08, 0x7F },   // H 
    { 0x00, 0x41, 0x7F, 0x41, 0x00 },   // I 
    { 0x20, 0x40, 0x41, 0x3F, 0x01 },   // J 
    { 0x7F, 0x08, 0x14, 0x22, 0x41 },   // K 
    { 0x7F, 0x40, 0x40, 0x40, 0x40 },   // L 
    { 0x7F, 0x02, 0x0C, 0x02, 0x7F },   // M 
    { 0x7F, 0x04, 0x08, 0x10, 0x7F },   // N 
    { 0x3E, 0x41, 0x41, 0x41, 0x3E },   // O 
    { 0x7F, 0x09, 0x09, 0x09, 0x06 },   // P 
    { 0x3E, 0x41, 0x51, 0x21, 0x5E },   // Q 
    { 0x7F, 0x09, 0x19, 0x29, 0x46 },   // R 
    { 0x46, 0x49, 0x49, 0x49, 0x31 },   // S 
    { 0x01, 0x01, 0x7F, 0x01, 0x01 },   // T 
    { 0x3F, 0x40, 0x40, 0x40, 0x3F },   // U 
    { 0x1F, 0x20, 0x40, 0x20, 0x1F },   // V 
    { 0x3F, 0x40, 0x38, 0x40, 0x3F },   // W 
    { 0x63, 0x14, 0x08, 0x14, 0x63 },   // X 
    { 0x07, 0x08, 0x70, 0x08, 0x07 },   // Y 
    { 0x61, 0x51, 0x49, 0x45, 0x43 },   // Z 
    { 0x00, 0x7F, 0x41, 0x41, 0x00 },   // [ 
    { 0x55, 0x2A, 0x55, 0x2A, 0x55 },   // 55 
    { 0x00, 0x41, 0x41, 0x7F, 0x00 },   // ] 
    { 0x04, 0x02, 0x01, 0x02, 0x04 },   // ^ 
    { 0x40, 0x40, 0x40, 0x40, 0x40 },   // _ 
    { 0x00, 0x01, 0x02, 0x04, 0x00 },   // ' 
    { 0x20, 0x54, 0x54, 0x54, 0x78 },   // a 
    { 0x7F, 0x48, 0x44, 0x44, 0x38 },   // b 
    { 0x38, 0x44, 0x44, 0x44, 0x20 },   // c 
    { 0x38, 0x44, 0x44, 0x48, 0x7F },   // d 
    { 0x38, 0x54, 0x54, 0x54, 0x18 },   // e 
    { 0x08, 0x7E, 0x09, 0x01, 0x02 },   // f 
    { 0x0C, 0x52, 0x52, 0x52, 0x3E },   // g 
    { 0x7F, 0x08, 0x04, 0x04, 0x78 },   // h 
    { 0x00, 0x44, 0x7D, 0x40, 0x00 },   // i 
    { 0x20, 0x40, 0x44, 0x3D, 0x00 },   // j 
    { 0x7F, 0x10, 0x28, 0x44, 0x00 },   // k 
    { 0x00, 0x41, 0x7F, 0x40, 0x00 },   // l 
    { 0x7C, 0x04, 0x18, 0x04, 0x78 },   // m 
    { 0x7C, 0x08, 0x04, 0x04, 0x78 },   // n 
    { 0x38, 0x44, 0x44, 0x44, 0x38 },   // o 
    { 0x7C, 0x14, 0x14, 0x14, 0x08 },   // p 
    { 0x08, 0x14, 0x14, 0x18, 0x7C },   // q 
    { 0x7C, 0x08, 0x04, 0x04, 0x08 },   // r 
    { 0x48, 0x54, 0x54, 0x54, 0x20 },   // s 
    { 0x04, 0x3F, 0x44, 0x40, 0x20 },   // t 
    { 0x3C, 0x40, 0x40, 0x20, 0x7C },   // u 
    { 0x1C, 0x20, 0x40, 0x20, 0x1C },   // v 
    { 0x3C, 0x40, 0x30, 0x40, 0x3C },   // w 
    { 0x44, 0x28, 0x10, 0x28, 0x44 },   // x 
    { 0x0C, 0x50, 0x50, 0x50, 0x3C },   // y 
    { 0x44, 0x64, 0x54, 0x4C, 0x44 }    // z 
};
/********************** DU LIEU ANH *********************************/

code  unsigned  char  Chu_nhan[]  =  
{
0xFF,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0xE1,0xF1,0xF1,0xFD,0x6D,0x3D,0x3D,0xFD,0xF9,0xF1,0xF1,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x0D,0x0D,
0x0D,0x0D,0x1D,0x1D,0x39,0x39,0x39,0x31,0x31,0x71,0x71,0xE1,0xE1,0xE1,0xE1,0x81,0x01,0x01,0x01,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1C,0x3E,0x3E,0xFF,0xFF,0xFF,0xFF,0xFF,0xBF,0xDE,0xDE,0xC0,0xE0,0xE0,0xE0,0xE0,0xC0,0x80,0x80,0x00,0xE0,0xFF,0xFF,0xFF,0xE3,0x78,0x3E,0x3E,0x1F,0xDF,0xEF,0xEF,0x30,0x18,0x08,
0x08,0x0C,0x86,0x86,0x86,0x82,0x03,0x01,0x61,0x61,0xF9,0x9B,0x1B,0x1B,0x1B,0x9E,0x1E,0x1E,0xFC,0xF8,0xF0,0xF0,0xE0,0xE0,0x60,0x60,0x60,0xE0,0xE0,0xE0,0xE0,0x61,0x7F,0x7F,0x7F,0x3F,0x3F,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x80,0x80,0x80,0xC0,0xC0,0xC0,0x40,0x40,0xFF,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0x7F,0xCF,0xCF,0xFB,0xFF,0xFF,0xFF,0xFF,0xF8,0xF8,0xF8,0xF8,0xF8,0x78,0xB8,0xB8,0xFC,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x1F,0x0F,0x0F,0x04,0x01,0x41,0x41,0xE1,0xF9,0xF8,0xF8,0xFF,0x7F,0x7F,0x7F,0x0F,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x3F,
0x7F,0xFF,0xFF,0xE3,0xC3,0x9D,0xBE,0xBE,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x3F,0x3F,0x87,0xFF,0xFF,0xFF,0xFF,0xC0,0x03,0x03,0x03,0x03,0x07,0x07,0x07,0x07,0x07,0xF3,0xF3,0xF9,0xBE,0x8F,0x8F,0xC7,0xF3,0xFF,0xFF,0xFF,0x9F,0xC7,0xC7,0xC3,0xE0,0xE0,0xF0,0xF0,0xF0,0xE0,0xE0,0xE0,0x00,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x07,0x07,0x07,0x06,0x06,0x06,0x06,0x06,0x0F,0x0F,0x1F,0x1F,0x1F,0x1F,0x1F,0x0F,0x07,0x07,0x00,0x00,0xE0,0xF0,0xF0,0xF0,0xF0,0xF8,0xF8,0xF8,0x88,0x08,0x08,0x00,0x00,0x0F,0x0F,0x1F,0x1F,0x1F,
0x1F,0x1F,0x1F,0x1F,0x0F,0x0F,0x0F,0x07,0x87,0x87,0x86,0x86,0xC6,0xC6,0xFE,0xFE,0xFC,0xFC,0x38,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
0x80,0x80,0x81,0x83,0x83,0x87,0x87,0x8F,0x8F,0x8F,0x8F,0x9F,0x9F,0xBE,0xBE,0xBE,0xBE,0xBE,0xBE,0xBE,0xBE,0xBE,0xBE,0x9E,0x9E,0x9E,0x9E,0x8F,0x8F,0x8F,0x8F,0x87,0x87,0x87,0x83,0x81,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0xFF
};
//////////////////// Ham ghi du lieu ///////////////////////////////////	
void Ghi_du_lieu(unsigned char du_lieu, unsigned char Chon_du_lieu) 
{    
	unsigned char i;   
	CE=0; 
	if (Chon_du_lieu == 0) DC=0;           
	else DC=1;  
	for(i=0;i<8;i++) 
	{         
		if(du_lieu&0x80) DIN=1;       
    	else  DIN=0;       
      CLK=0;       
      du_lieu = du_lieu << 1;       
      CLK=1;    
  }     
  CE=1; 
}
//////////////////// Ham dinh vi vi tri ///////////////////////////////////	
void Toa_do(unsigned char x, unsigned char y) 
{ 
	Ghi_du_lieu(0x80|x, 0);    
	Ghi_du_lieu(0x40|y, 0); 
	}
//////////////////// Xoa LCD ///////////////////////////////////	
void Xoa_trang(void)     
		{  
			unsigned char t;  
			unsigned char k;  
			Toa_do(0,0);  
      for(t=0;t<6;t++)  
{    
for(k=0;k<84;k++)   
	{     
		Ghi_du_lieu(0x00,1);        
		}   
		} 
		}
//////////////////// In ky tu ///////////////////////////////////
void In_ky_tu(unsigned char x,unsigned char y,char dat) 
			{
	unsigned char v;
	if((dat >= 0x20) && (dat <= 0x7a)){
		dat=dat-32;
			Toa_do(x,y);
		for(v=0;v<5;v++)
			Ghi_du_lieu(font5[dat][v],1);
	}
}
//////////////////// In chuoi ky tu ///////////////////////////////////
void In_chuoi_ky_tu(unsigned char x,unsigned char y,char *s) 
{    
	while(*s)     
		{       
			In_ky_tu(x,y,*s);      
			s++;      
			x += 6; // Vi chu co do rong la 5 nÃªn ta dih 6 de tao dan cah chu    
			} 
			}
//////////////////// Ham in anh ///////////////////////////////////
void In_anh(unsigned char x,unsigned char y,unsigned char const *map,unsigned char chieu_dai_anh,unsigned char chieu_rong_anh) 
{  
	unsigned int i,n;  
	unsigned char hang; 
	if (chieu_dai_anh%8==0) hang=chieu_rong_anh/8;           
	else                    hang=chieu_rong_anh/8+1; 
	Toa_do(x,y);    
	for (n=0;n<hang;n++)  
	  {      
     for(i=0;i<chieu_dai_anh;i++)     
     {       
      Toa_do(x+i,y+n);         
      Ghi_du_lieu(map[i+n*chieu_dai_anh], 1);       
     }                             
     }       
}
////////////////////Khoi tao GLCD///////////////////////////////////
void Khoi_tao_lcd(void) 
{ 
// Ham khoi tao dua tren datasheet de chinh sua cho hop ly	
	RST=0; 
	RST=1;      
	Ghi_du_lieu(0x21, 0);     // Mo che do o rong
	Ghi_du_lieu(0x80+45, 0);  // Set do tuong phan
	Ghi_du_lieu(0x04+0, 0);   // Set thong so nhiet
	Ghi_du_lieu(0x10+4, 0);   // Set thong so BIAS
	Ghi_du_lieu(0x20, 0);     // Dong che do o rong
	Ghi_du_lieu(0x0C, 0);     // Hien thi binh thuong ,0x0D Am ban
}

//Ket thu thu vien
